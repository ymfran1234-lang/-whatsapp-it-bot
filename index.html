<!DOCTYPE html>

<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×‘×•×˜ IT ×¦×‘××™</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap');

:root {
â€“green: #00ff88;
â€“bg: #080b0d;
â€“card: #0f1419;
â€“border: #1a2820;
â€“text: #c8d8c8;
â€“muted: #4a6050;
â€“user-bubble: #0d2818;
â€“bot-bubble: #111a14;
}

- { box-sizing: border-box; margin: 0; padding: 0; }

body {
background: var(â€“bg);
color: var(â€“text);
font-family: â€˜Heeboâ€™, sans-serif;
height: 100dvh;
display: flex;
flex-direction: column;
overflow: hidden;
}

/* â”€â”€ Header â”€â”€ */
header {
padding: 0.85rem 1.25rem;
border-bottom: 1px solid var(â€“border);
display: flex;
align-items: center;
gap: 0.75rem;
background: rgba(8,11,13,0.97);
flex-shrink: 0;
}
.logo {
width: 34px; height: 34px;
background: #071208;
border: 1px solid var(â€“green);
border-radius: 6px;
display: flex; align-items: center; justify-content: center;
font-size: 1rem;
}
.header-title { font-weight: 900; color: #fff; font-size: 0.95rem; }
.header-sub { font-size: 0.68rem; color: var(â€“muted); }
.dot {
width: 7px; height: 7px;
background: var(â€“green);
border-radius: 50%;
margin-right: auto;
box-shadow: 0 0 6px var(â€“green);
animation: pulse 2s infinite;
}
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }

/* â”€â”€ Messages â”€â”€ */
.messages {
flex: 1;
overflow-y: auto;
padding: 1rem 1.25rem;
display: flex;
flex-direction: column;
gap: 0.85rem;
scroll-behavior: smooth;
}
.messages::-webkit-scrollbar { width: 3px; }
.messages::-webkit-scrollbar-thumb { background: var(â€“border); border-radius: 2px; }

.msg { display: flex; gap: 0.6rem; align-items: flex-start; animation: fadeUp 0.2s ease; }
@keyframes fadeUp { from{opacity:0;transform:translateY(6px)} to{opacity:1;transform:translateY(0)} }
.msg.user { flex-direction: row-reverse; }

.avatar {
width: 28px; height: 28px; min-width: 28px;
border-radius: 5px; font-size: 0.8rem;
display: flex; align-items: center; justify-content: center;
border: 1px solid var(â€“border);
}
.msg.bot .avatar { background: #071208; border-color: var(â€“green); }
.msg.user .avatar { background: #0d1a10; }

.bubble {
max-width: 78%;
padding: 0.7rem 1rem;
border-radius: 8px;
font-size: 0.88rem;
line-height: 1.7;
border: 1px solid var(â€“border);
white-space: pre-wrap;
word-break: break-word;
}
.msg.bot .bubble { background: var(â€“bot-bubble); border-radius: 3px 8px 8px 8px; }
.msg.user .bubble { background: var(â€“user-bubble); border-radius: 8px 3px 8px 8px; }

/* Staff cards inside bubble */
.staff-card {
display: flex;
align-items: center;
gap: 10px;
background: #071208;
border: 1px solid #1a3020;
border-radius: 6px;
padding: 10px 14px;
text-decoration: none;
color: var(â€“text);
margin-top: 8px;
transition: border-color 0.2s;
}
.staff-card:hover { border-color: var(â€“green); }
.staff-name { font-weight: 700; color: #fff; font-size: 0.85rem; }
.staff-phone { font-size: 0.75rem; color: var(â€“green); }

/* Typing dots */
.typing-bubble { display: flex; gap: 4px; align-items: center; padding: 0.75rem 1rem; }
.dot-t { width: 6px; height: 6px; background: var(â€“green); border-radius: 50%; animation: bounce 1.2s infinite; }
.dot-t:nth-child(2) { animation-delay: 0.2s; }
.dot-t:nth-child(3) { animation-delay: 0.4s; }
@keyframes bounce { 0%,60%,100%{transform:translateY(0);opacity:0.4} 30%{transform:translateY(-5px);opacity:1} }

/* Welcome */
.welcome {
text-align: center;
padding: 2rem 1rem;
display: flex; flex-direction: column;
align-items: center; justify-content: center;
gap: 1rem;
}
.welcome-icon {
width: 60px; height: 60px;
background: #071208; border: 1px solid var(â€“green);
border-radius: 12px; font-size: 1.7rem;
display: flex; align-items: center; justify-content: center;
box-shadow: 0 0 25px #00ff8818;
}
.welcome h2 { color: #fff; font-size: 1.2rem; font-weight: 900; }
.welcome p { color: var(â€“muted); font-size: 0.82rem; max-width: 300px; line-height: 1.6; }
.quick-btns { display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; margin-top: 0.25rem; }
.quick-btn {
background: var(â€“card); border: 1px solid var(â€“border);
border-radius: 20px; padding: 0.35rem 0.8rem;
font-size: 0.78rem; cursor: pointer; color: var(â€“text);
font-family: â€˜Heeboâ€™, sans-serif; transition: all 0.2s;
}
.quick-btn:hover { border-color: var(â€“green); color: var(â€“green); }

/* â”€â”€ Input â”€â”€ */
.input-area {
padding: 0.85rem 1.25rem;
border-top: 1px solid var(â€“border);
background: rgba(8,11,13,0.97);
flex-shrink: 0;
display: flex;
gap: 0.6rem;
align-items: flex-end;
}
textarea#userInput {
flex: 1;
background: var(â€“card);
border: 1px solid var(â€“border);
border-radius: 6px;
padding: 0.65rem 0.9rem;
color: var(â€“text);
font-family: â€˜Heeboâ€™, sans-serif;
font-size: 0.9rem;
direction: rtl;
resize: none;
min-height: 44px; max-height: 120px;
line-height: 1.5;
transition: border-color 0.2s;
}
textarea#userInput:focus { outline: none; border-color: var(â€“green); }
textarea#userInput::placeholder { color: var(â€“muted); }
#sendBtn {
width: 44px; height: 44px;
background: var(â€“green); border: none;
border-radius: 6px; cursor: pointer;
font-size: 1rem; transition: opacity 0.2s;
}
#sendBtn:hover { opacity: 0.85; }
#sendBtn:disabled { opacity: 0.3; cursor: not-allowed; }
</style>

</head>
<body>

<header>
  <div class="logo">ğŸ–¥ï¸</div>
  <div>
    <div class="header-title">×‘×•×˜ IT ×¦×‘××™</div>
    <div class="header-sub">×ª××™×›×” ×˜×›× ×™×ª Â· ××—×œ×§×ª ×”×ª×§×©×•×‘</div>
  </div>
  <div class="dot"></div>
</header>

<div class="messages" id="messages">
  <div class="welcome" id="welcome">
    <div class="welcome-icon">ğŸ–¥ï¸</div>
    <h2>×‘×•×˜ IT ×¦×‘××™</h2>
    <p>×©××œ ××•×ª×™ ×›×œ ×©××œ×” ×‘×ª×—×•× ×”××—×©×•×‘. ××¢×–×•×¨ ×œ×š ×œ×¤×ª×•×¨ ×ª×§×œ×•×ª ×¦×¢×“ ×¦×¢×“.</p>
    <div class="quick-btns">
      <button class="quick-btn" onclick="quickAsk('××“×¤×¡×ª ×œ× ××“×¤×™×¡×”')">ğŸ–¨ï¸ ××“×¤×¡×ª</button>
      <button class="quick-btn" onclick="quickAsk('××¡×š ×œ× ××–×•×”×”')">ğŸ–¥ï¸ ××¡×š</button>
      <button class="quick-btn" onclick="quickAsk('×“×¨×™×™×‘×¨ ×—×¡×¨')">â¬‡ï¸ ×“×¨×™×™×‘×¨</button>
      <button class="quick-btn" onclick="quickAsk('××™×Ÿ ×¨×©×ª ×‘××—×©×‘')">ğŸŒ ×¨×©×ª</button>
      <button class="quick-btn" onclick="quickAsk('××§×¨×Ÿ ×œ× ××ª×—×‘×¨')">ğŸ“½ï¸ ××§×¨×Ÿ</button>
    </div>
  </div>
</div>

<div class="input-area">
  <textarea id="userInput" placeholder="×©××œ ×©××œ×” ×˜×›× ×™×ª..." rows="1"
    onkeydown="handleKey(event)" oninput="autoResize(this)"></textarea>
  <button id="sendBtn" onclick="sendMessage()">â¤</button>
</div>

<script>
// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let apiKey = localStorage.getItem("gemini_api_key") || "";
let history = [];
let isLoading = false;

// â”€â”€ Staff contacts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const STAFF = [
  { name: "×œ×™××‘ ×˜×•×–×œ×™",   phone: "0523800049", wa: "972523800049" },
  { name: "×˜×œ×™×” ×™××“×’×¨",   phone: "0556636013", wa: "972556636013" },
  { name: "×˜×œ×™×” ×’×•×¨×Ÿ",    phone: "0556654153", wa: "972556654153" },
  { name: "×’×™×•×¨× ××’×•×¨",   phone: "0542104737", wa: "972542104737" },
];

// â”€â”€ System Prompt â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SYSTEM_PROMPT = `××ª×” ×‘×•×˜ ×ª××™×›×” ×˜×›× ×™×ª IT ×¦×‘××™ ××§×¦×•×¢×™.
×¢× ×” ×‘×¢×‘×¨×™×ª ×‘×œ×‘×“.
×ª×Ÿ ×”×¡×‘×¨×™× ×‘×¨×•×¨×™× ×¢× ×©×œ×‘×™× ×××•×¡×¤×¨×™×.
×”×©×ª××© ×‘××™××•×’'×™ ×›×“×™ ×œ×”×‘×”×™×¨ ×©×œ×‘×™×.
××ª×” ××•××—×” ×‘: ××“×¤×¡×•×ª, ×“×¨×™×™×‘×¨×™×, ××¡×›×™×, ×¤×œ×–××•×ª, ××§×¨× ×™×, ×¨×©×ª×•×ª, Windows.

×××’×¨ ×ª×§×œ×•×ª × ×¤×•×¦×•×ª:

[××“×¤×¡×ª ×œ× ××“×¤×™×¡×”]
1. ×‘×“×•×§ ×©×”××“×¤×¡×ª ×“×œ×•×§×” (××•×¨ ×™×¨×•×§/×›×—×•×œ)
2. ×‘×“×•×§ ×›×‘×œ USB/×¨×©×ª ××—×•×‘×¨ ××©× ×™ ×”×¦×“×“×™×
3. ×œ×•×— ×‘×§×¨×” -> ××›×©×™×¨×™× ×•××“×¤×¡×•×ª -> ×‘×“×•×§ ×¡×™××Ÿ ××–×”×¨×”
4. ×œ×—×¥ ×™×× ×™ ×¢×œ ××“×¤×¡×ª -> ×¨××” ××” ××•×“×¤×¡ -> ××—×§ ×”×›×œ
5. Win+R -> services.msc -> Print Spooler -> ×”×¤×¢×œ ××—×“×©
6. ×œ×—×¥ ×™×× ×™ ×¢×œ ××“×¤×¡×ª -> ×××¤×™×™× ×™× -> ×”×“×¤×¡ ×“×£ ×‘×“×™×§×”

[××¡×š/×¤×œ×–××” ×œ× ××–×•×”×”]
1. ×‘×“×•×§ ×©×”××¡×š ×“×œ×•×§ ×•×›×‘×œ ×—×©××œ ××—×•×‘×¨
2. ×”×•×¦×/×”×›× ×¡ ×›×‘×œ HDMI/VGA ××©× ×™ ×”×¦×“×“×™×
3. ×‘×©×œ×˜: Source/Input -> ×‘×—×¨ HDMI1/HDMI2/PC
4. Win+P -> ×©×›×¤×œ
5. ×œ×—×¥ ×™×× ×™ ×©×•×œ×—×Ÿ ×¢×‘×•×“×” -> ×”×’×“×¨×•×ª ×ª×¦×•×’×” -> ×–×”×”

[×“×¨×™×™×‘×¨ ×—×¡×¨]
1. ×œ×—×¥ ×™×× ×™ ×”××—×©×‘ ×©×œ×™ -> × ×”×œ -> ×× ×”×œ ×”×”×ª×§× ×™×
2. ×—×¤×© ×”×ª×§×Ÿ ×¢× ×¡×™××Ÿ ××–×”×¨×” ×¦×”×•×‘
3. ×œ×—×¥ ×™×× ×™ -> ×¢×“×›×Ÿ ×× ×”×œ ×”×ª×§×Ÿ -> ×—×¤×© ××•×˜×•××˜×™×ª
4. HP: support.hp.com | Canon: canon.com/support | Dell: dell.com/support
5. ×”×¤×¢×œ ×›×× ×”×œ ××¢×¨×›×ª -> ×”×¤×¢×œ ××—×“×©

[××§×¨×Ÿ ×œ× ××ª×—×‘×¨]
1. ×”××ª×Ÿ 60 ×©× ×™×•×ª ×œ×—×™××•×
2. ×‘×“×•×§ ×›×‘×œ HDMI/VGA
3. Source ×‘××§×¨×Ÿ -> ×‘×—×¨ ×›× ×™×¡×” × ×›×•× ×”
4. Win+P -> ×©×›×¤×œ

[××™×Ÿ ×¨×©×ª]
1. ×‘×“×•×§ ×›×‘×œ ×¨×©×ª ××—×•×‘×¨
2. ×‘×“×•×§ ×× ×©××¨ ×”××—×©×‘×™× ×‘×—×“×¨ ××—×•×‘×¨×™×
3. ×œ×—×¥ ×™×× ×™ ×¡××œ ×¨×©×ª -> ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª
4. cmd ×›×× ×”×œ: ipconfig /release, ipconfig /renew, ipconfig /flushdns
5. ×›×‘×”/×”×“×œ×§ ××—×©×‘

×—×©×•×‘: ×× ×”××©×ª××© ××•××¨ ×©×”×¤×ª×¨×•×Ÿ ×œ× ×¢×–×¨ ××—×¨×™ ××¡×¤×¨ × ×™×¡×™×•× ×•×ª â€” 
×¢× ×”: "ESCALATE" ×‘×œ×‘×“ (××™×œ×” ××—×ª, ×œ×œ× ×©×•× ×˜×§×¡×˜ ××—×¨).
×‘×›×œ ×©××¨ ×”××§×¨×™× â€” ×¢× ×” ×‘×¢×‘×¨×™×ª ×›×¨×’×™×œ.`;

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.onload = () => {
  if (!apiKey) promptApiKey();
};

function promptApiKey() {
  const key = prompt("ğŸ”‘ ×”×›× ×¡ ××ª ××¤×ª×— ×”-Gemini API ×©×œ×š (×—×™× ××™ ×-aistudio.google.com):");
  if (key && key.trim()) {
    apiKey = key.trim();
    localStorage.setItem("gemini_api_key", apiKey);
  }
}

// â”€â”€ Input helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function handleKey(e) {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
}

function autoResize(el) {
  el.style.height = "auto";
  el.style.height = Math.min(el.scrollHeight, 120) + "px";
}

function quickAsk(q) {
  document.getElementById("userInput").value = q;
  sendMessage();
}

// â”€â”€ Send â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function sendMessage() {
  const input = document.getElementById("userInput");
  const text = input.value.trim();
  if (!text || isLoading) return;

  if (!apiKey) { promptApiKey(); return; }

  // Remove welcome screen
  const welcome = document.getElementById("welcome");
  if (welcome) welcome.remove();

  addMessage("user", text);
  input.value = "";
  input.style.height = "auto";
  history.push({ role: "user", parts: [{ text }] });

  isLoading = true;
  document.getElementById("sendBtn").disabled = true;
  const typingId = showTyping();

  try {
    const reply = await callGemini(text);

    removeTyping(typingId);

    if (reply.trim() === "ESCALATE") {
      showEscalation();
    } else {
      addMessage("bot", reply);
      history.push({ role: "model", parts: [{ text: reply }] });
    }

  } catch (err) {
    removeTyping(typingId);
    addMessage("bot", "âš ï¸ ×©×’×™××”: " + err.message + "\n\n× ×¡×” ×©×•×‘ ××• ×‘×“×•×§ ××ª ××¤×ª×— ×”-API.");
  }

  isLoading = false;
  document.getElementById("sendBtn").disabled = false;
}

// â”€â”€ Gemini API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function callGemini(userMessage) {
  const contents = [
    { role: "user",  parts: [{ text: SYSTEM_PROMPT }] },
    { role: "model", parts: [{ text: "××•×›×Ÿ ×œ×¢×–×•×¨!" }] },
    ...history.slice(-6),
    { role: "user",  parts: [{ text: userMessage }] }
  ];

  const response = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`,
    {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        contents,
        generationConfig: { temperature: 0.6, maxOutputTokens: 800 }
      })
    }
  );

  if (!response.ok) {
    const err = await response.json().catch(() => ({}));
    throw new Error("API Error " + response.status + (err.error?.message ? ": " + err.error.message : ""));
  }

  const data = await response.json();
  return data.candidates?.[0]?.content?.parts?.map(p => p.text).join("") || "×œ× ×”×ª×§×‘×œ×” ×ª×©×•×‘×”.";
}

// â”€â”€ DOM helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function addMessage(role, text) {
  const container = document.getElementById("messages");
  const msgDiv = document.createElement("div");
  msgDiv.className = "msg " + role;

  const avatar = document.createElement("div");
  avatar.className = "avatar";
  avatar.textContent = role === "bot" ? "ğŸ–¥ï¸" : "ğŸ‘¤";

  const bubble = document.createElement("div");
  bubble.className = "bubble";
  bubble.textContent = text; // âœ… ×××•×‘×˜×— ××¤× ×™ XSS

  msgDiv.appendChild(avatar);
  msgDiv.appendChild(bubble);
  container.appendChild(msgDiv);
  container.scrollTop = container.scrollHeight;
}

function showEscalation() {
  const container = document.getElementById("messages");
  const msgDiv = document.createElement("div");
  msgDiv.className = "msg bot";

  const avatar = document.createElement("div");
  avatar.className = "avatar";
  avatar.textContent = "ğŸ–¥ï¸";

  const bubble = document.createElement("div");
  bubble.className = "bubble";

  // Header text â€” safe
  const header = document.createElement("p");
  header.textContent = "ğŸ˜” ××¦×˜×¢×¨ ×©×¢×“×™×™×Ÿ ×œ× × ×¤×ª×¨! ×”×‘×¢×™×” ××•×¨×›×‘×ª ××“×™ ×œ×¤×ª×¨×•×Ÿ ××¨×—×•×§.";
  header.style.marginBottom = "6px";

  const subheader = document.createElement("p");
  subheader.textContent = "ğŸ“ ×¤× ×” ×œ××—×“ ××›×•× × ×™ ×”××—×©×•×‘:";
  subheader.style.marginBottom = "8px";
  subheader.style.fontWeight = "700";

  bubble.appendChild(header);
  bubble.appendChild(subheader);

  // Staff cards â€” built safely with DOM
  STAFF.forEach(person => {
    const link = document.createElement("a");
    link.href = "https://wa.me/" + person.wa;
    link.target = "_blank";
    link.className = "staff-card";

    const icon = document.createElement("span");
    icon.textContent = "ğŸ’¬";
    icon.style.fontSize = "1.3rem";

    const info = document.createElement("div");

    const name = document.createElement("div");
    name.className = "staff-name";
    name.textContent = person.name;

    const phone = document.createElement("div");
    phone.className = "staff-phone";
    phone.textContent = person.phone + " Â· ×œ×—×¥ ×œ×¤×ª×™×—×ª WhatsApp";

    info.appendChild(name);
    info.appendChild(phone);
    link.appendChild(icon);
    link.appendChild(info);
    bubble.appendChild(link);
  });

  msgDiv.appendChild(avatar);
  msgDiv.appendChild(bubble);
  container.appendChild(msgDiv);
  container.scrollTop = container.scrollHeight;
}

function showTyping() {
  const container = document.getElementById("messages");
  const id = "typing-" + Date.now();
  const msgDiv = document.createElement("div");
  msgDiv.className = "msg bot";
  msgDiv.id = id;

  const avatar = document.createElement("div");
  avatar.className = "avatar";
  avatar.textContent = "ğŸ–¥ï¸";

  const bubble = document.createElement("div");
  bubble.className = "bubble typing-bubble";
  [1,2,3].forEach(i => {
    const d = document.createElement("div");
    d.className = "dot-t";
    bubble.appendChild(d);
  });

  msgDiv.appendChild(avatar);
  msgDiv.appendChild(bubble);
  container.appendChild(msgDiv);
  container.scrollTop = container.scrollHeight;
  return id;
}

function removeTyping(id) {
  document.getElementById(id)?.remove();
}
</script>

</body>
</html>
