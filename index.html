<!DOCTYPE html>

<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×‘×•×˜ IT ×¦×‘××™</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Heebo:wght@300;400;700;900&display=swap');

:root {
â€“green: #00ff88;
â€“green-dim: #00cc66;
â€“bg: #080b0d;
â€“card: #0f1419;
â€“border: #1a2820;
â€“text: #c8d8c8;
â€“muted: #4a6050;
â€“user-bubble: #0d2818;
â€“bot-bubble: #111a14;
}

- { box-sizing: border-box; margin: 0; padding: 0; }

body {
background: var(â€“bg);
color: var(â€“text);
font-family: â€˜Heeboâ€™, sans-serif;
height: 100dvh;
display: flex;
flex-direction: column;
overflow: hidden;
background-image:
radial-gradient(ellipse at 100% 0%, #071a0f 0%, transparent 50%),
radial-gradient(ellipse at 0% 100%, #050d08 0%, transparent 50%);
}

/* â”€â”€ Header â”€â”€ */
header {
padding: 0.85rem 1.25rem;
border-bottom: 1px solid var(â€“border);
display: flex;
align-items: center;
gap: 1rem;
background: rgba(8,11,13,0.95);
backdrop-filter: blur(10px);
flex-shrink: 0;
}
.logo {
width: 36px; height: 36px;
background: #071208;
border: 1px solid var(â€“green);
border-radius: 6px;
display: flex; align-items: center; justify-content: center;
font-size: 1.1rem;
flex-shrink: 0;
}
.header-text h1 {
font-size: 0.95rem;
font-weight: 700;
color: #fff;
}
.header-text p {
font-size: 0.7rem;
color: var(â€“muted);
font-family: â€˜IBM Plex Monoâ€™, monospace;
}
.status-dot {
width: 7px; height: 7px;
background: var(â€“green);
border-radius: 50%;
margin-right: auto;
box-shadow: 0 0 6px var(â€“green);
animation: pulse 2s infinite;
}
@keyframes pulse {
0%, 100% { opacity: 1; }
50% { opacity: 0.4; }
}
.setup-btn {
background: transparent;
border: 1px solid var(â€“border);
border-radius: 4px;
padding: 0.35rem 0.75rem;
color: var(â€“muted);
font-family: â€˜IBM Plex Monoâ€™, monospace;
font-size: 0.7rem;
cursor: pointer;
transition: all 0.2s;
}
.setup-btn:hover { border-color: var(â€“green); color: var(â€“green); }

/* â”€â”€ Setup Panel â”€â”€ */
.setup-panel {
display: none;
background: var(â€“card);
border-bottom: 1px solid var(â€“border);
padding: 1rem 1.25rem;
flex-shrink: 0;
}
.setup-panel.open { display: block; }
.setup-title {
font-family: â€˜IBM Plex Monoâ€™, monospace;
font-size: 0.7rem;
color: var(â€“green);
letter-spacing: 2px;
margin-bottom: 0.75rem;
}
.setup-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 0.75rem;
}
@media (max-width: 600px) { .setup-grid { grid-template-columns: 1fr; } }
.setup-field label {
display: block;
font-size: 0.72rem;
color: var(â€“muted);
margin-bottom: 0.3rem;
font-family: â€˜IBM Plex Monoâ€™, monospace;
}
.setup-field input, .setup-field textarea {
width: 100%;
background: #080b0d;
border: 1px solid var(â€“border);
border-radius: 4px;
padding: 0.5rem 0.75rem;
color: var(â€“text);
font-family: â€˜Heeboâ€™, sans-serif;
font-size: 0.82rem;
direction: rtl;
transition: border-color 0.2s;
resize: vertical;
}
.setup-field input:focus, .setup-field textarea:focus {
outline: none;
border-color: var(â€“green);
}
.setup-field textarea { min-height: 80px; }
.setup-save {
margin-top: 0.75rem;
background: var(â€“green);
border: none;
border-radius: 4px;
padding: 0.5rem 1.25rem;
color: #000;
font-family: â€˜Heeboâ€™, sans-serif;
font-weight: 700;
font-size: 0.85rem;
cursor: pointer;
transition: opacity 0.2s;
}
.setup-save:hover { opacity: 0.85; }
.setup-hint {
font-size: 0.72rem;
color: var(â€“muted);
margin-top: 0.5rem;
font-family: â€˜IBM Plex Monoâ€™, monospace;
}
.setup-hint a {
color: var(â€“green);
text-decoration: none;
}

/* â”€â”€ Messages â”€â”€ */
.messages {
flex: 1;
overflow-y: auto;
padding: 1.25rem;
display: flex;
flex-direction: column;
gap: 0.85rem;
scroll-behavior: smooth;
}
.messages::-webkit-scrollbar { width: 4px; }
.messages::-webkit-scrollbar-track { background: transparent; }
.messages::-webkit-scrollbar-thumb { background: var(â€“border); border-radius: 2px; }

.msg {
display: flex;
gap: 0.65rem;
align-items: flex-start;
animation: fadeUp 0.25s ease;
}
@keyframes fadeUp {
from { opacity: 0; transform: translateY(8px); }
to   { opacity: 1; transform: translateY(0); }
}
.msg.user { flex-direction: row-reverse; }

.avatar {
width: 30px; height: 30px; min-width: 30px;
border-radius: 5px;
display: flex; align-items: center; justify-content: center;
font-size: 0.85rem;
border: 1px solid var(â€“border);
}
.msg.bot .avatar { background: #071208; border-color: var(â€“green); }
.msg.user .avatar { background: #0d1a10; }

.bubble {
max-width: 78%;
padding: 0.7rem 1rem;
border-radius: 8px;
font-size: 0.88rem;
line-height: 1.7;
border: 1px solid var(â€“border);
}
.msg.bot .bubble {
background: var(â€“bot-bubble);
border-color: #1a2e1e;
border-radius: 3px 8px 8px 8px;
}
.msg.user .bubble {
background: var(â€“user-bubble);
border-color: #1a3a20;
border-radius: 8px 3px 8px 8px;
text-align: right;
}

.bubble code {
background: #071208;
border: 1px solid var(â€“border);
border-radius: 3px;
padding: 0.1rem 0.4rem;
font-family: â€˜IBM Plex Monoâ€™, monospace;
font-size: 0.78rem;
color: #88ffcc;
}
.bubble strong { color: #fff; }

.source-tag {
display: inline-flex; align-items: center; gap: 0.3rem;
background: #071208;
border: 1px solid var(â€“border);
border-radius: 3px;
padding: 0.15rem 0.5rem;
font-family: â€˜IBM Plex Monoâ€™, monospace;
font-size: 0.65rem;
color: var(â€“muted);
margin-top: 0.5rem;
}
.source-tag.web { color: #66aaff; border-color: #1a2a40; }
.source-tag.local { color: var(â€“green); border-color: #1a3020; }

/* Typing indicator */
.typing .bubble {
display: flex; gap: 4px; align-items: center;
padding: 0.75rem 1rem;
}
.dot {
width: 6px; height: 6px;
background: var(â€“green);
border-radius: 50%;
animation: bounce 1.2s infinite;
}
.dot:nth-child(2) { animation-delay: 0.2s; }
.dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes bounce {
0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
30% { transform: translateY(-5px); opacity: 1; }
}

/* â”€â”€ Input â”€â”€ */
.input-area {
padding: 0.85rem 1.25rem;
border-top: 1px solid var(â€“border);
background: rgba(8,11,13,0.95);
backdrop-filter: blur(10px);
flex-shrink: 0;
}
.input-row {
display: flex;
gap: 0.6rem;
align-items: flex-end;
}
textarea#userInput {
flex: 1;
background: var(â€“card);
border: 1px solid var(â€“border);
border-radius: 6px;
padding: 0.65rem 0.9rem;
color: var(â€“text);
font-family: â€˜Heeboâ€™, sans-serif;
font-size: 0.9rem;
direction: rtl;
resize: none;
min-height: 44px;
max-height: 120px;
line-height: 1.5;
transition: border-color 0.2s;
}
textarea#userInput:focus { outline: none; border-color: var(â€“green); }
textarea#userInput::placeholder { color: var(â€“muted); }

.send-btn {
width: 44px; height: 44px;
background: var(â€“green);
border: none;
border-radius: 6px;
color: #000;
font-size: 1.1rem;
cursor: pointer;
display: flex; align-items: center; justify-content: center;
transition: opacity 0.2s, transform 0.1s;
flex-shrink: 0;
}
.send-btn:hover { opacity: 0.85; }
.send-btn:active { transform: scale(0.95); }
.send-btn:disabled { opacity: 0.3; cursor: not-allowed; }

.input-hint {
font-family: â€˜IBM Plex Monoâ€™, monospace;
font-size: 0.65rem;
color: var(â€“muted);
margin-top: 0.4rem;
text-align: center;
}

/* â”€â”€ Welcome â”€â”€ */
.welcome {
text-align: center;
padding: 2rem 1rem;
flex: 1;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
gap: 1rem;
}
.welcome-icon {
width: 64px; height: 64px;
background: #071208;
border: 1px solid var(â€“green);
border-radius: 12px;
display: flex; align-items: center; justify-content: center;
font-size: 1.8rem;
box-shadow: 0 0 30px #00ff8820;
}
.welcome h2 { font-size: 1.3rem; font-weight: 900; color: #fff; }
.welcome p { font-size: 0.85rem; color: var(â€“muted); max-width: 320px; line-height: 1.6; }
.quick-btns {
display: flex; flex-wrap: wrap; gap: 0.5rem;
justify-content: center; margin-top: 0.5rem;
}
.quick-btn {
background: var(â€“card);
border: 1px solid var(â€“border);
border-radius: 20px;
padding: 0.4rem 0.9rem;
font-size: 0.8rem;
cursor: pointer;
color: var(â€“text);
transition: all 0.2s;
font-family: â€˜Heeboâ€™, sans-serif;
}
.quick-btn:hover { border-color: var(â€“green); color: var(â€“green); }

/* No API key warning */
.no-key-warning {
background: #1a0800;
border: 1px solid #ff6b35;
border-radius: 6px;
padding: 0.75rem 1rem;
font-size: 0.82rem;
color: #ff9966;
margin-bottom: 0.75rem;
line-height: 1.5;
}
</style>

</head>
<body>

<header>
  <div class="logo">ğŸ–¥ï¸</div>
  <div class="header-text">
    <h1>×‘×•×˜ IT ×¦×‘××™</h1>
    <p>// gemini Â· web_search Â· military_kb</p>
  </div>
  <div class="status-dot"></div>
  <button class="setup-btn" onclick="toggleSetup()">âš™ï¸ ×”×’×“×¨×•×ª</button>
</header>

<div class="setup-panel" id="setupPanel">
  <div class="setup-title">// CONFIGURATION</div>
  <div class="setup-grid">
    <div class="setup-field">
      <label>ğŸ”‘ Gemini API Key</label>
      <input type="password" id="apiKey" placeholder="AIza..." />
      <div class="setup-hint">
        ×§×‘×œ ××¤×ª×— ×—×™× ××™: <a href="https://aistudio.google.com/app/apikey" target="_blank">aistudio.google.com</a>
      </div>
    </div>
    <div class="setup-field">
      <label>ğŸª– ××™×“×¢ ×¦×‘××™ ××™×•×—×“</label>
      <textarea id="militaryKb" placeholder="×”×›× ×¡ ×›××Ÿ ××™×“×¢ ×¡×¤×¦×™×¤×™ ×©×”×‘×•×˜ ×¦×¨×™×š ×œ×“×¢×ª:&#10;- ×©××•×ª ×ª×•×›× ×•×ª ×¤× ×™××™×•×ª&#10;- × ×”×œ×™× ××™×•×—×“×™×&#10;- ×§×™×©×•×¨×™× ×œ×“×¨×™×™×‘×¨×™× ×¦×‘××™×™×&#10;- ×”×•×¨××•×ª ××™×•×—×“×•×ª..."></textarea>
    </div>
  </div>
  <button class="setup-save" onclick="saveSettings()">×©××•×¨ ×”×’×“×¨×•×ª âœ“</button>
</div>

<div id="chatArea" style="flex:1; display:flex; flex-direction:column; overflow:hidden;">

  <div class="messages" id="messages">
    <div class="welcome" id="welcome">
      <div class="welcome-icon">ğŸ–¥ï¸</div>
      <h2>×‘×•×˜ IT ×¦×‘××™</h2>
      <p>×©××œ ××•×ª×™ ×›×œ ×©××œ×” ×‘×ª×—×•× ×”××—×©×•×‘. ××—×¤×© ×‘×¨×©×ª ×•××©×ª××© ×‘××™×“×¢ ×”×¦×‘××™ ×©×”×–× ×ª.</p>
      <div class="quick-btns">
        <button class="quick-btn" onclick="askQuick('××“×¤×¡×ª ×œ× ××“×¤×™×¡×”, ××” ×¢×•×©×™×?')">ğŸ–¨ï¸ ××“×¤×¡×ª ×œ× ××“×¤×™×¡×”</button>
        <button class="quick-btn" onclick="askQuick('××¡×š ×œ× ××–×•×”×” ×œ××—×©×‘')">ğŸ–¥ï¸ ××¡×š ×œ× ××–×•×”×”</button>
        <button class="quick-btn" onclick="askQuick('××™×š ××•×¨×™×“ ×“×¨×™×™×‘×¨ ×—×¡×¨?')">â¬‡ï¸ ×“×¨×™×™×‘×¨ ×—×¡×¨</button>
        <button class="quick-btn" onclick="askQuick('××™×Ÿ ×¨×©×ª ×‘××—×©×‘')">ğŸŒ ××™×Ÿ ×¨×©×ª</button>
        <button class="quick-btn" onclick="askQuick('××§×¨×Ÿ ×œ× ××ª×—×‘×¨ ×œ××—×©×‘')">ğŸ“½ï¸ ××§×¨×Ÿ ×œ× ××ª×—×‘×¨</button>
      </div>
    </div>
  </div>

</div>

<div class="input-area">
  <div id="noKeyWarning" class="no-key-warning" style="display:none;">
    âš ï¸ ×›×“×™ ×œ×”×©×ª××© ×‘×‘×•×˜ â€” ×œ×—×¥ ×¢×œ <strong>âš™ï¸ ×”×’×“×¨×•×ª</strong> ×œ××¢×œ×” ×•×”×›× ×¡ ××ª ××¤×ª×— ×”-Gemini ×”×—×™× ××™ ×©×œ×š.
  </div>
  <div class="input-row">
    <textarea id="userInput" placeholder="×©××œ ×©××œ×” ×˜×›× ×™×ª..." rows="1"
      onkeydown="handleKey(event)" oninput="autoResize(this)"></textarea>
    <button class="send-btn" id="sendBtn" onclick="sendMessage()">â¤</button>
  </div>
  <div class="input-hint">Enter ×œ×©×œ×™×—×” Â· Shift+Enter ×œ×©×•×¨×” ×—×“×©×” Â· ××—×¤×© ×‘×¨×©×ª ×‘×–××Ÿ ×××ª ğŸŒ</div>
</div>

<script>
// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let apiKey = localStorage.getItem('gemini_api_key') || '';
let militaryKb = localStorage.getItem('military_kb') || '';
let history = [];
let isLoading = false;

const MILITARY_SYSTEM = `××ª×” ×‘×•×˜ ×ª××™×›×” ×˜×›× ×™×ª IT ×¦×‘××™ ××§×¦×•×¢×™. 
××ª×” ×¢×•× ×” ×‘×¢×‘×¨×™×ª ×‘×œ×‘×“.
××ª×” ××•××—×” ×‘: ××“×¤×¡×•×ª, ×“×¨×™×™×‘×¨×™×, ××¡×›×™×, ×¤×œ×–××•×ª, ××§×¨× ×™×, ×¨×©×ª×•×ª, Windows troubleshooting.
×ª×Ÿ ×”×¡×‘×¨×™× ×‘×¨×•×¨×™× ×¢× ×©×œ×‘×™× ×××•×¡×¤×¨×™×.
×”×©×ª××© ×‘××™××•×’×³×™ ×›×“×™ ×œ×”×‘×”×™×¨ ×©×œ×‘×™×.
×× ×”××™×“×¢ ×”×¦×‘××™ ×”×¤× ×™××™ ×¨×œ×•×•× ×˜×™ â€” ×”×©×ª××© ×‘×• ×§×•×“×.
×× ×¦×¨×™×š â€” ×¦×™×™×Ÿ ×©×›×“××™ ×œ×¤× ×•×ª ×œ×˜×›× ××™.`;

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.onload = () => {
  document.getElementById('apiKey').value = apiKey;
  document.getElementById('militaryKb').value = militaryKb;
  if (!apiKey) {
    document.getElementById('noKeyWarning').style.display = 'block';
    document.getElementById('setupPanel').classList.add('open');
  }
};

// â”€â”€ Settings â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleSetup() {
  document.getElementById('setupPanel').classList.toggle('open');
}

function saveSettings() {
  apiKey = document.getElementById('apiKey').value.trim();
  militaryKb = document.getElementById('militaryKb').value.trim();
  localStorage.setItem('gemini_api_key', apiKey);
  localStorage.setItem('military_kb', militaryKb);
  document.getElementById('setupPanel').classList.remove('open');
  document.getElementById('noKeyWarning').style.display = apiKey ? 'none' : 'block';

  const btn = document.querySelector('.setup-save');
  btn.textContent = 'âœ… × ×©××¨!';
  setTimeout(() => btn.textContent = '×©××•×¨ ×”×’×“×¨×•×ª âœ“', 1500);
}

// â”€â”€ Chat Logic â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function askQuick(q) {
  document.getElementById('userInput').value = q;
  sendMessage();
}

function handleKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
}

function autoResize(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 120) + 'px';
}

async function sendMessage() {
  const input = document.getElementById('userInput');
  const text = input.value.trim();
  if (!text || isLoading) return;

  if (!apiKey) {
    document.getElementById('setupPanel').classList.add('open');
    document.getElementById('noKeyWarning').style.display = 'block';
    return;
  }

  // Hide welcome
  const welcome = document.getElementById('welcome');
  if (welcome) welcome.remove();

  // Add user message
  addMessage('user', text);
  input.value = '';
  input.style.height = 'auto';
  history.push({ role: 'user', parts: [{ text }] });

  // Show typing
  const typingId = showTyping();
  isLoading = true;
  document.getElementById('sendBtn').disabled = true;

  try {
    const reply = await callGemini(text);
    removeTyping(typingId);
    addMessage('bot', reply, true);
    history.push({ role: 'model', parts: [{ text: reply }] });
  } catch (err) {
    removeTyping(typingId);
    addMessage('bot', `âš ï¸ ×©×’×™××”: ${err.message}\n\n×‘×“×•×§ ×©××¤×ª×— ×”-API × ×›×•×Ÿ ×‘×”×’×“×¨×•×ª.`);
  }

  isLoading = false;
  document.getElementById('sendBtn').disabled = false;
}

async function callGemini(userMessage) {
  // Build system context with military KB
  const systemContext = MILITARY_SYSTEM + (militaryKb
    ? `\n\n=== ××™×“×¢ ×¦×‘××™ ×¤× ×™××™ ===\n${militaryKb}`
    : '');

  // Build messages with history
  const messages = [
    { role: 'user', parts: [{ text: systemContext + '\n\n×”××©×ª××© ×©×•××œ: ' + userMessage }] },
    { role: 'model', parts: [{ text: '×”×‘× ×ª×™. ×× ×™ ××•×›×Ÿ ×œ×¢× ×•×ª ×¢×œ ×©××œ×•×ª IT ×¦×‘××™×•×ª.' }] },
    ...history.slice(-8), // last 8 messages for context
    { role: 'user', parts: [{ text: userMessage }] }
  ];

  // Remove last user message duplication
  const finalMessages = history.length === 0
    ? [{ role: 'user', parts: [{ text: systemContext + '\n\n×©××œ×”: ' + userMessage }] }]
    : [
        { role: 'user', parts: [{ text: systemContext }] },
        { role: 'model', parts: [{ text: '××•×›×Ÿ ×œ×¢×–×•×¨!' }] },
        ...history.slice(-6),
        { role: 'user', parts: [{ text: userMessage }] }
      ];

  const response = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`,
    {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        contents: finalMessages,
        tools: [{ google_search: {} }],
        generationConfig: {
          temperature: 0.7,
          maxOutputTokens: 1024,
        }
      })
    }
  );

  if (!response.ok) {
    const err = await response.json();
    throw new Error(err.error?.message || `HTTP ${response.status}`);
  }

  const data = await response.json();
  const candidate = data.candidates?.[0];
  if (!candidate) throw new Error('×œ× ×”×ª×§×‘×œ×” ×ª×©×•×‘×” ×-Gemini');

  const text = candidate.content?.parts?.map(p => p.text || '').join('') || '';
  const hasWebSearch = candidate.groundingMetadata?.webSearchQueries?.length > 0;

  return { text, hasWebSearch };
}

// â”€â”€ DOM Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function addMessage(role, content, fromGemini = false) {
  const msgs = document.getElementById('messages');
  const div = document.createElement('div');
  div.className = `msg ${role}`;

  let text = typeof content === 'object' ? content.text : content;
  const hasWebSearch = typeof content === 'object' ? content.hasWebSearch : false;

  // Format text
  text = text
    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
    .replace(/`([^`]+)`/g, '<code>$1</code>')
    .replace(/\n/g, '<br>');

  const sourceTag = hasWebSearch
    ? '<br><span class="source-tag web">ğŸŒ ××—×¤×© ×‘×¨×©×ª ×‘×–××Ÿ ×××ª</span>'
    : (fromGemini && militaryKb ? '<br><span class="source-tag local">ğŸª– ×›×•×œ×œ ××™×“×¢ ×¦×‘××™ ×¤× ×™××™</span>' : '');

  div.innerHTML = `
    <div class="avatar">${role === 'bot' ? 'ğŸ–¥ï¸' : 'ğŸ‘¤'}</div>
    <div class="bubble">${text}${sourceTag}</div>
  `;

  msgs.appendChild(div);
  msgs.scrollTop = msgs.scrollHeight;
}

function showTyping() {
  const msgs = document.getElementById('messages');
  const id = 'typing-' + Date.now();
  const div = document.createElement('div');
  div.className = 'msg bot typing';
  div.id = id;
  div.innerHTML = `
    <div class="avatar">ğŸ–¥ï¸</div>
    <div class="bubble">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  `;
  msgs.appendChild(div);
  msgs.scrollTop = msgs.scrollHeight;
  return id;
}

function removeTyping(id) {
  document.getElementById(id)?.remove();
}
</script>

</body>
</html>